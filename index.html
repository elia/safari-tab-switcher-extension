<script type="text/javascript">
safari.application.addEventListener("message",captureMessageEvent,false);

function captureMessageEvent(event) {
	if (event.name == 'switchTabs') {
		var window = safari.application.activeBrowserWindow;
		var index = event.message-49;
		window.tabs[index].activate();
	} else if (event.name == 'getKeyCombo') {
		safari.application.activeBrowserWindow.activeTab.page.dispatchMessage("keyCombo", safari.extension.settings.getItem('keyCombo'));
	}
}

</script>